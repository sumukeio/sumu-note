# 弹窗替换进度

## 目标
将所有原生 `confirm()` 和 `alert()` 替换为应用内部的 Dialog 和 Toast。

## 替换规则
- **危险操作确认**（删除、永久删除等）→ Dialog 确认
- **信息提示**（成功、失败、警告）→ Toast 提示
- **输入操作**（重命名、编辑等）→ Dialog 表单

---

## 已完成 ✅

### 1. Toast 组件创建
- ✅ `src/components/ui/toast.tsx` - Toast 组件
- ✅ `src/components/ui/use-toast.ts` - Toast Hook
- ✅ `src/components/ui/toaster.tsx` - Toaster 容器
- ✅ `src/app/layout.tsx` - 添加 Toaster 到根布局

### 2. NoteManager.tsx（高优先级）
- ✅ 删除当前笔记 → Dialog 确认
- ✅ 批量删除（回收站）→ Dialog 确认
- ✅ 批量还原 → Toast 提示
- ✅ 复制内容 → Toast 提示
- ✅ 重命名笔记 → Dialog 表单
- ✅ 发布/取消发布 → Toast 提示
- ✅ 图片上传成功/失败 → Toast 提示

### 3. SegmentedEditor.tsx
- ✅ 链接跳转确认 → Dialog 确认

### 4. FolderManager.tsx
- ✅ 删除文件夹确认 → Dialog
- ✅ 移动文件夹确认 → Dialog
- ✅ 重命名失败提示 → Toast

### 5. ExportDialog.tsx
- ✅ 加载失败提示 → Toast
- ✅ 导出成功/失败提示 → Toast

### 6. AuthModal.tsx
- ✅ 注册/登录提示 → Toast

### 7. TodoList.tsx
- ✅ 批量删除任务确认 → Dialog
- ✅ 批量操作失败提示 → Toast（完成/删除/移动/标签/优先级）

---

## 待替换 ⏳

### TodoContextMenu.tsx
- ⏳ 删除任务确认 → Dialog

### TodoListSidebar.tsx
- ⏳ 删除清单确认 → Dialog
- ⏳ 操作失败提示 → Toast

### TodoDetail.tsx
- ⏳ 删除任务确认 → Dialog
- ⏳ 删除子任务确认 → Dialog
- ⏳ 操作失败提示 → Toast

### MindNoteEditor.tsx
- ⏳ 删除节点确认 → Dialog
- ⏳ 操作失败提示 → Toast

### MindNoteManager.tsx
- ⏳ 批量删除确认 → Dialog
- ⏳ 操作失败提示 → Toast

### DraggableMindNode.tsx
- ⏳ 删除节点确认 → Dialog

### dashboard/settings/page.tsx
- ⏳ 设置保存成功/失败 → Toast

---

## 替换模板

### Dialog 确认模板
```tsx
const [confirmDialogOpen, setConfirmDialogOpen] = useState(false);

<Dialog open={confirmDialogOpen} onOpenChange={setConfirmDialogOpen}>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>确认操作</DialogTitle>
      <DialogDescription>
        操作描述...
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <Button variant="outline" onClick={() => setConfirmDialogOpen(false)}>
        取消
      </Button>
      <Button variant="destructive" onClick={handleConfirm}>
        确认
      </Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

### Toast 提示模板
```tsx
const { toast } = useToast();

// 成功提示
toast({
  title: "操作成功",
  description: "详细描述",
  variant: "success",
});

// 失败提示
toast({
  title: "操作失败",
  description: "错误信息",
  variant: "destructive",
});

// 普通提示
toast({
  title: "提示",
  description: "信息",
  variant: "default",
});
```

---

## 更新记录
- 2026-01-XX: 创建文档，开始替换 NoteManager.tsx 和 SegmentedEditor.tsx
- 2026-01-XX: 完成 FolderManager.tsx、ExportDialog.tsx、AuthModal.tsx 的弹窗替换
- 2026-01-XX: 完成 TodoList.tsx 的弹窗替换（批量删除确认 Dialog + 所有批量操作错误提示 Toast）

## 统计
- **已完成组件数**: 7 个（NoteManager, SegmentedEditor, FolderManager, ExportDialog, AuthModal, TodoList）
- **待替换组件数**: 6 个（TodoContextMenu, TodoListSidebar, TodoDetail, MindNoteEditor, MindNoteManager, DraggableMindNode）
- **完成进度**: 约 54% (7/13)

## 统计
- **已完成组件数**: 7 个（NoteManager, SegmentedEditor, FolderManager, ExportDialog, AuthModal, TodoList）
- **待替换组件数**: 6 个（TodoContextMenu, TodoListSidebar, TodoDetail, MindNoteEditor, MindNoteManager, DraggableMindNode）
- **完成进度**: 约 54% (7/13)
- 2026-01-XX: 完成 FolderManager.tsx、ExportDialog.tsx、AuthModal.tsx 的弹窗替换
- 2026-01-XX: 完成 TodoList.tsx 的弹窗替换（批量删除确认 Dialog + 所有批量操作错误提示 Toast）
